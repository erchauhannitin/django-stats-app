{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="" />
    <meta name="author" content="" />

    <title>Stat Reports</title>
    <script src="{% static 'statreports/sorttable.js' %}"></script>

    <!-- Bootstrap core CSS -->
    <link
      href="{% static 'statreports/bootstrap.min.css' %}"
      rel="stylesheet"
    />
    <!-- Bootstrap theme -->
    <link
      href="{% static 'statreports/bootstrap-theme.min.css' %}"
      rel="stylesheet"
    />

    <!-- Custom styles for this template -->
    <link href="{% static 'statreports/theme.css' %}" rel="stylesheet" />
  </head>

  <body>
    <div class="container theme-showcase" role="main">
      <h3>
        <span>Filter Table Data</span>
        <input
          type="search"
          placeholder="Search..."
          class="form-control search-input"
          data-table="rows-list"
        />
      </h3>
      <table
        class="sortable rows-list"
        border="1"
        cellpadding="5"
        cellspacing="5"
      >
        <td>Name</td>
        <td>Address</td>
        <td>Count</td>
        <td>Errors</td>

        {% for row in rows %}
        <tr class="page-header">
          <td>{{ row.name }}</td>
          <td>{{ row.address }}</td>
          <td>{{ row.count }}</td>
          <td>{{ row.errors }}</td>
        </tr>
        {% endfor %}
      </table>
    </div>

    <div>
      {% if rows.has_previous %}
      <a href="{% url 'index' %}?page={{rows.previous_page_number}}"
        >Previous</a
      >
      {% endif %} {% if rows.has_next %}
      <a href="{% url 'index' %}?page={{rows.next_page_number}}">Next</a>
      {% endif %}
    </div>
    <script>
      (function (document) {
        "use strict";

        var TableFilter = (function (myArray) {
          var search_input;

          function _onInputSearch(e) {
            search_input = e.target;
            var tables = document.getElementsByClassName(
              search_input.getAttribute("data-table")
            );
            myArray.forEach.call(tables, function (table) {
              myArray.forEach.call(table.tBodies, function (tbody) {
                myArray.forEach.call(tbody.rows, function (row) {
                  var text_content = row.textContent.toLowerCase();
                  var search_val = search_input.value.toLowerCase();
                  row.style.display =
                    text_content.indexOf(search_val) > -1 ? "" : "none";
                });
              });
            });
          }

          return {
            init: function () {
              var inputs = document.getElementsByClassName("search-input");
              myArray.forEach.call(inputs, function (input) {
                input.oninput = _onInputSearch;
              });
            },
          };
        })(Array.prototype);

        document.addEventListener("readystatechange", function () {
          if (document.readyState === "complete") {
            TableFilter.init();
          }
        });
      })(document);
    </script>
  </body>
</html>
